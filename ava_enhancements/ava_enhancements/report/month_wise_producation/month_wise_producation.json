{
 "add_total_row": 0,
 "columns": [],
 "creation": "2025-06-12 00:29:13.864373",
 "disable_prepared_report": 0,
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [],
 "idx": 0,
 "is_standard": "Yes",
 "letter_head": "Letter",
 "modified": "2025-06-12 00:29:13.864373",
 "modified_by": "Administrator",
 "module": "Ava Enhancements",
 "name": "Month-Wise Producation",
 "owner": "Administrator",
 "prepared_report": 0,
 "query": "SELECT * FROM (\n    SELECT\n        sed.item_code AS `Item Code`,\n        sed.item_name AS `Item Name`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 1 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Jan 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 1 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Jan 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 2 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Feb 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 2 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Feb 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 3 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Mar 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 3 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Mar 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 4 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Apr 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 4 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Apr 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 5 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `May 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 5 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `May 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 6 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Jun 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 6 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Jun 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 7 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Jul 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 7 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Jul 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 8 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Aug 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 8 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Aug 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 9 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Sep 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 9 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Sep 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 10 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Oct 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 10 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Oct 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 11 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Nov 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 11 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Nov 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 12 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Dec 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 12 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Dec 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Total 2025 Qty`,\n        FORMAT(SUM(CASE WHEN YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Total 2025 Cases`\n\n    FROM\n        `tabStock Entry` se\n    JOIN\n        `tabStock Entry Detail` sed ON se.name = sed.parent\n    WHERE\n        se.stock_entry_type = 'Manufacture'\n        AND sed.is_finished_item = 1\n        AND YEAR(se.posting_date) = 2025\n        AND sed.item_code != '104000001'\n        AND se.docstatus = 1\n    GROUP BY\n        sed.item_code, sed.item_name\n\n    UNION ALL\n\n    SELECT\n        '<b>Total</b>' AS `Item Code`,\n        '' AS `Item Name`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 1 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Jan 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 1 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Jan 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 2 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Feb 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 2 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Feb 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 3 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Mar 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 3 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Mar 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 4 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Apr 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 4 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Apr 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 5 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `May 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 5 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `May 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 6 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Jun 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 6 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Jun 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 7 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Jul 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 7 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Jul 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 8 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Aug 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 8 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Aug 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 9 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Sep 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 9 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Sep 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 10 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Oct 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 10 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Oct 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 11 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Nov 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 11 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Nov 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 12 AND YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Dec 2025 Qty`,\n        FORMAT(SUM(CASE WHEN MONTH(se.posting_date) = 12 AND YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Dec 2025 Cases`,\n\n        FORMAT(SUM(CASE WHEN YEAR(se.posting_date) = 2025 THEN sed.qty ELSE 0 END), 2) AS `Total 2025 Qty`,\n        FORMAT(SUM(CASE WHEN YEAR(se.posting_date) = 2025 THEN sed.cases ELSE 0 END), 2) AS `Total 2025 Cases`\n\n    FROM\n        `tabStock Entry` se\n    JOIN\n        `tabStock Entry Detail` sed ON se.name = sed.parent\n    WHERE\n        se.stock_entry_type = 'Manufacture'\n        AND sed.is_finished_item = 1\n        AND YEAR(se.posting_date) = 2025\n        AND sed.item_code != '104000001'\n) AS final_result\nORDER BY\n    CASE\n        WHEN `Item Code` = '<b>Total</b>' THEN 1\n        ELSE 0\n    END,\n    `Item Code`;\n",
 "ref_doctype": "Stock Entry",
 "report_name": "Month-Wise Producation",
 "report_script": "from __future__ import unicode_literals\nimport frappe\nfrom frappe import _\n\ndef execute(filters=None):\n    columns = get_columns()\n    data = get_data()\n    return columns, data\n\ndef get_columns():\n    return [\n        {\"fieldname\": \"item_code\", \"label\": \"Item Code\", \"fieldtype\": \"Data\", \"width\": 120},\n        {\"fieldname\": \"item_name\", \"label\": \"Item Name\", \"fieldtype\": \"Data\", \"width\": 150},\n        {\"fieldname\": \"jan_2025_qty\", \"label\": \"Jan 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"jan_2025_cases\", \"label\": \"Jan 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"feb_2025_qty\", \"label\": \"Feb 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"feb_2025_cases\", \"label\": \"Feb 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"mar_2025_qty\", \"label\": \"Mar 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"mar_2025_cases\", \"label\": \"Mar 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"apr_2025_qty\", \"label\": \"Apr 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"apr_2025_cases\", \"label\": \"Apr 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"may_2025_qty\", \"label\": \"May 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"may_2025_cases\", \"label\": \"May 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"jun_2025_qty\", \"label\": \"Jun 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"jun_2025_cases\", \"label\": \"Jun 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"jul_2025_qty\", \"label\": \"Jul 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"jul_2025_cases\", \"label\": \"Jul 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"aug_2025_qty\", \"label\": \"Aug 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"aug_2025_cases\", \"label\": \"Aug 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"sep_2025_qty\", \"label\": \"Sep 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"sep_2025_cases\", \"label\": \"Sep 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"oct_2025_qty\", \"label\": \"Oct 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"oct_2025_cases\", \"label\": \"Oct 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"nov_2025_qty\", \"label\": \"Nov 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"nov_2025_cases\", \"label\": \"Nov 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"dec_2025_qty\", \"label\": \"Dec 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"dec_2025_cases\", \"label\": \"Dec 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 100, \"precision\": 2},\n        {\"fieldname\": \"total_2025_qty\", \"label\": \"Total 2025 Qty\", \"fieldtype\": \"Float\", \"width\": 120, \"precision\": 2},\n        {\"fieldname\": \"total_2025_cases\", \"label\": \"Total 2025 Cases\", \"fieldtype\": \"Float\", \"width\": 120, \"precision\": 2},\n    ]\n\ndef get_data():\n    # Fetch item-wise data\n    query = \"\"\"\n        SELECT\n            sed.item_code,\n            sed.item_name,\n            SUM(CASE WHEN MONTH(se.posting_date) = 1 THEN sed.qty ELSE 0 END) AS jan_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 1 THEN sed.cases ELSE 0 END) AS jan_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 2 THEN sed.qty ELSE 0 END) AS feb_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 2 THEN sed.cases ELSE 0 END) AS feb_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 3 THEN sed.qty ELSE 0 END) AS mar_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 3 THEN sed.cases ELSE 0 END) AS mar_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 4 THEN sed.qty ELSE 0 END) AS apr_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 4 THEN sed.cases ELSE 0 END) AS apr_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 5 THEN sed.qty ELSE 0 END) AS may_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 5 THEN sed.cases ELSE 0 END) AS may_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 6 THEN sed.qty ELSE 0 END) AS jun_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 6 THEN sed.cases ELSE 0 END) AS jun_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 7 THEN sed.qty ELSE 0 END) AS jul_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 7 THEN sed.cases ELSE 0 END) AS jul_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 8 THEN sed.qty ELSE 0 END) AS aug_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 8 THEN sed.cases ELSE 0 END) AS aug_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 9 THEN sed.qty ELSE 0 END) AS sep_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 9 THEN sed.cases ELSE 0 END) AS sep_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 10 THEN sed.qty ELSE 0 END) AS oct_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 10 THEN sed.cases ELSE 0 END) AS oct_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 11 THEN sed.qty ELSE 0 END) AS nov_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 11 THEN sed.cases ELSE 0 END) AS nov_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 12 THEN sed.qty ELSE 0 END) AS dec_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 12 THEN sed.cases ELSE 0 END) AS dec_2025_cases,\n            SUM(sed.qty) AS total_2025_qty,\n            SUM(sed.cases) AS total_2025_cases\n        FROM\n            `tabStock Entry` se\n        JOIN\n            `tabStock Entry Detail` sed ON se.name = sed.parent\n        WHERE\n            se.stock_entry_type = 'Manufacture'\n            AND sed.is_finished_item = 1\n            AND YEAR(se.posting_date) = 2025\n            AND sed.item_code != '104000001'\n            AND se.docstatus = 1\n        GROUP BY\n            sed.item_code, sed.item_name\n    \"\"\"\n    item_data = frappe.db.sql(query, as_dict=True)\n\n    # Fetch total data\n    total_query = \"\"\"\n        SELECT\n            SUM(CASE WHEN MONTH(se.posting_date) = 1 THEN sed.qty ELSE 0 END) AS jan_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 1 THEN sed.cases ELSE 0 END) AS jan_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 2 THEN sed.qty ELSE 0 END) AS feb_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 2 THEN sed.cases ELSE 0 END) AS feb_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 3 THEN sed.qty ELSE 0 END) AS mar_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 3 THEN sed.cases ELSE 0 END) AS mar_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 4 THEN sed.qty ELSE 0 END) AS apr_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 4 THEN sed.cases ELSE 0 END) AS apr_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 5 THEN sed.qty ELSE 0 END) AS may_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 5 THEN sed.cases ELSE 0 END) AS may_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 6 THEN sed.qty ELSE 0 END) AS jun_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 6 THEN sed.cases ELSE 0 END) AS jun_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 7 THEN sed.qty ELSE 0 END) AS jul_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 7 THEN sed.cases ELSE 0 END) AS jul_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 8 THEN sed.qty ELSE 0 END) AS aug_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 8 THEN sed.cases ELSE 0 END) AS aug_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 9 THEN sed.qty ELSE 0 END) AS sep_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 9 THEN sed.cases ELSE 0 END) AS sep_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 10 THEN sed.qty ELSE 0 END) AS oct_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 10 THEN sed.cases ELSE 0 END) AS oct_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 11 THEN sed.qty ELSE 0 END) AS nov_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 11 THEN sed.cases ELSE 0 END) AS nov_2025_cases,\n            SUM(CASE WHEN MONTH(se.posting_date) = 12 THEN sed.qty ELSE 0 END) AS dec_2025_qty,\n            SUM(CASE WHEN MONTH(se.posting_date) = 12 THEN sed.cases ELSE 0 END) AS dec_2025_cases,\n            SUM(sed.qty) AS total_2025_qty,\n            SUM(sed.cases) AS total_2025_cases\n        FROM\n            `tabStock Entry` se\n        JOIN\n            `tabStock Entry Detail` sed ON se.name = sed.parent\n        WHERE\n            se.stock_entry_type = 'Manufacture'\n            AND sed.is_finished_item = 1\n            AND YEAR(se.posting_date) = 2025\n            AND sed.item_code != '104000001'\n            AND se.docstatus = 1\n    \"\"\"\n    total_data = frappe.db.sql(total_query, as_dict=True)\n\n    # Format data\n    formatted_data = []\n    for row in item_data:\n        formatted_data.append({\n            \"item_code\": row.item_code,\n            \"item_name\": row.item_name,\n            \"jan_2025_qty\": round(row.jan_2025_qty, 2),\n            \"jan_2025_cases\": round(row.jan_2025_cases, 2),\n            \"feb_2025_qty\": round(row.feb_2025_qty, 2),\n            \"feb_2025_cases\": round(row.feb_2025_cases, 2),\n            \"mar_2025_qty\": round(row.mar_2025_qty, 2),\n            \"mar_2025_cases\": round(row.mar_2025_cases, 2),\n            \"apr_2025_qty\": round(row.apr_2025_qty, 2),\n            \"apr_2025_cases\": round(row.apr_2025_cases, 2),\n            \"may_2025_qty\": round(row.may_2025_qty, 2),\n            \"may_2025_cases\": round(row.may_2025_cases, 2),\n            \"jun_2025_qty\": round(row.jun_2025_qty, 2),\n            \"jun_2025_cases\": round(row.jun_2025_cases, 2),\n            \"jul_2025_qty\": round(row.jul_2025_qty, 2),\n            \"jul_2025_cases\": round(row.jul_2025_cases, 2),\n            \"aug_2025_qty\": round(row.aug_2025_qty, 2),\n            \"aug_2025_cases\": round(row.aug_2025_cases, 2),\n            \"sep_2025_qty\": round(row.sep_2025_qty, 2),\n            \"sep_2025_cases\": round(row.sep_2025_cases, 2),\n            \"oct_2025_qty\": round(row.oct_2025_qty, 2),\n            \"oct_2025_cases\": round(row.oct_2025_cases, 2),\n            \"nov_2025_qty\": round(row.nov_2025_qty, 2),\n            \"nov_2025_cases\": round(row.nov_2025_cases, 2),\n            \"dec_2025_qty\": round(row.dec_2025_qty, 2),\n            \"dec_2025_cases\": round(row.dec_2025_cases, 2),\n            \"total_2025_qty\": round(row.total_2025_qty, 2),\n            \"total_2025_cases\": round(row.total_2025_cases, 2),\n        })\n\n    # Add total row\n    if total_data:\n        formatted_data.append({\n            \"item_code\": \"<b>Total</b>\",\n            \"item_name\": \"\",\n            \"jan_2025_qty\": round(total_data[0].jan_2025_qty, 2),\n            \"jan_2025_cases\": round(total_data[0].jan_2025_cases, 2),\n            \"feb_2025_qty\": round(total_data[0].feb_2025_qty, 2),\n            \"feb_2025_cases\": round(total_data[0].feb_2025_cases, 2),\n            \"mar_2025_qty\": round(total_data[0].mar_2025_qty, 2),\n            \"mar_2025_cases\": round(total_data[0].mar_2025_cases, 2),\n            \"apr_2025_qty\": round(total_data[0].apr_2025_qty, 2),\n            \"apr_2025_cases\": round(total_data[0].apr_2025_cases, 2),\n            \"may_2025_qty\": round(total_data[0].may_2025_qty, 2),\n            \"may_2025_cases\": round(total_data[0].may_2025_cases, 2),\n            \"jun_2025_qty\": round(total_data[0].jun_2025_qty, 2),\n            \"jun_2025_cases\": round(total_data[0].jun_2025_cases, 2),\n            \"jul_2025_qty\": round(total_data[0].jul_2025_qty, 2),\n            \"jul_2025_cases\": round(total_data[0].jul_2025_cases, 2),\n            \"aug_2025_qty\": round(total_data[0].aug_2025_qty, 2),\n            \"aug_2025_cases\": round(total_data[0].aug_2025_cases, 2),\n            \"sep_2025_qty\": round(total_data[0].sep_2025_qty, 2),\n            \"sep_2025_cases\": round(total_data[0].sep_2025_cases, 2),\n            \"oct_2025_qty\": round(total_data[0].oct_2025_qty, 2),\n            \"oct_2025_cases\": round(total_data[0].oct_2025_cases, 2),\n            \"nov_2025_qty\": round(total_data[0].nov_2025_qty, 2),\n            \"nov_2025_cases\": round(total_data[0].nov_2025_cases, 2),\n            \"dec_2025_qty\": round(total_data[0].dec_2025_qty, 2),\n            \"dec_2025_cases\": round(total_data[0].dec_2025_cases, 2),\n            \"total_2025_qty\": round(total_data[0].total_2025_qty, 2),\n            \"total_2025_cases\": round(total_data[0].total_2025_cases, 2),\n        })\n\n    # Sort data to ensure Total row is last\n    formatted_data.sort(key=lambda x: 1 if x[\"item_code\"] == \"<b>Total</b>\" else 0)\n\n    return formatted_data",
 "report_type": "Script Report",
 "roles": [
  {
   "role": "Manufacturing User"
  },
  {
   "role": "Stock User"
  },
  {
   "role": "01 Production Supervisor"
  },
  {
   "role": "01 Production Manager"
  },
  {
   "role": "01 Mechanical Engineer"
  },
  {
   "role": "01 Electrical Engineer"
  },
  {
   "role": "01 Maintenance Supervisor"
  },
  {
   "role": "01 Maintenance Manager"
  },
  {
   "role": "01 Microbiology analyst"
  },
  {
   "role": "01 Quality specialist"
  },
  {
   "role": "01 Plant Manager"
  },
  {
   "role": "01 Quality Supervisor"
  },
  {
   "role": "01 Quality Manager"
  },
  {
   "role": "System Manager"
  },
  {
   "role": "01 IA"
  },
  {
   "role": "01 Stock Controller (Central)"
  },
  {
   "role": "IT Team Member"
  },
  {
   "role": "System Manager"
  },
  {
   "role": "01 Chief Accountant"
  }
 ]
}